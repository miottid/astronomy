name: test
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - uses: avsm/setup-ocaml@v2
        with:
          ocaml-compiler: 4.11.x

      - run: opam install --yes --deps-only --with-test .
      - run: opam exec -- dune build
      - run: opam exec -- dune build @test/runtest
